# Full VQ-VAE Training on 1K Dataset
# Validates topology metrics, per-category metrics, and adaptive codebook sizing

# Dataset
input_path: datasets/test_1k_inline_features.h5
output_dir: checkpoints/vqvae_1k_full_integrated_metrics

# Feature configuration
feature_family: summary
feature_type: aggregated

# Category discovery (auto-clustering with adaptive codebook sizing)
category_assignment: auto
min_features_per_category: 3
max_clusters: 25

# Model architecture
group_embedding_dim: 64
group_hidden_dim: 128

# Training (full training to convergence)
epochs: 300
batch_size: 256
learning_rate: 0.0007
val_every_n_epochs: 5
random_seed: 42

# VQ-VAE hyperparameters (from unisim production config)
commitment_cost: 0.45
use_ema: true
decay: 0.99

# Loss weights (matching unisim exactly)
orthogonality_weight: 0.1
informativeness_weight: 0.1
orthogonality_target: 0.15
topo_weight: 0.02
topo_samples: 64

# Callbacks
early_stopping_patience: 100
early_stopping_min_delta: 0.01
dead_code_reset_interval: 100
dead_code_threshold: 10.0
dead_code_max_reset_fraction: 0.25

# Optimization
use_torch_compile: false  # Disable for stability
device: cuda
verbose: true
